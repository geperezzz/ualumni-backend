generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model JobOffer {
  id               String           @id @default(uuid()) @db.Uuid
  description      String
  companyName      String
  companyContact   String
  companyLogo      Bytes
  department       String
  position         String
  offerLocation    String
  offerDate        DateTime
  career           Career           @relation(fields: [careerId], references: [id])
  careerId         String           @db.Uuid
  applications     JobApplication[]
  contractType     ContractType     @relation(fields: [contractTypeName], references: [name])
  contractTypeName String
}

model ContractType {
  name                String     @id
  contractsOfThisType JobOffer[]
}

model Career {
  id            String         @id @default(uuid()) @db.Uuid
  name          String         @unique
  jobOffers     JobOffer[]
  alumniResumes AlumniResume[]
}

model Alumni {
  email           String           @id
  password        String
  names           String
  surnames        String
  jobApplications JobApplication[]
  resumes         AlumniResume[]
}

model JobApplication {
  jobOffer              JobOffer @relation(fields: [jobOfferId], references: [id])
  jobOfferId            String   @db.Uuid
  alumniWhoApplied      Alumni   @relation(fields: [alumniWhoAppliedEmail], references: [email])
  alumniWhoAppliedEmail String
  applicationDate       DateTime

  @@id([jobOfferId, alumniWhoAppliedEmail])
}

model Resume {
  id                     String                 @id @default(uuid()) @db.Uuid
  numberOfDownloads      Int
  isVisible              Boolean
  aboutMe                String
  knownLanguages         ResumeLanguage[]
  portfolio              PortfolioItem[]
  higherEducationStudies HigherEducationStudy[]
  softSkills             SoftSkill[]
  technicalSkills        TechnicalSkill[]
  ciapCourses            CiapCourse[]
  positionsOfInterest    PositionOfInterest[]
  industriesOfInterest   IndustryOfInterest[]
  owner                  AlumniResume?
}

model CiapCourse {
  id                 String   @id @default(uuid()) @db.Uuid
  name               String
  resumesListingThis Resume[]
}

model SoftSkill {
  name               String   @id
  resumesListingThis Resume[]
}

model TechnicalSkill {
  resume   Resume @relation(fields: [resumeId], references: [id])
  resumeId String @db.Uuid
  name     String

  @@id([resumeId, name])
}

model Language {
  name    String           @id
  knownBy ResumeLanguage[]
}

model ResumeLanguage {
  resume       Resume   @relation(fields: [resumeId], references: [id])
  resumeId     String   @db.Uuid
  language     Language @relation(fields: [languageName], references: [name])
  languageName String
  masteryLevel Int

  @@id([resumeId, languageName])
}

model PortfolioItem {
  resume      Resume @relation(fields: [resumeId], references: [id])
  resumeId    String @db.Uuid
  title       String
  description String

  @@id([resumeId, title])
}

model HigherEducationStudy {
  resume      Resume   @relation(fields: [resumeId], references: [id])
  resumeId    String   @db.Uuid
  title       String
  institution String
  startDate   DateTime
  endDate     DateTime

  @@id([resumeId, title])
}

model PositionOfInterest {
  resume       Resume @relation(fields: [resumeId], references: [id])
  resumeId     String @db.Uuid
  positionName String

  @@id([resumeId, positionName])
}

model IndustryOfInterest {
  resume       Resume @relation(fields: [resumeId], references: [id])
  resumeId     String @db.Uuid
  industryName String

  @@id([resumeId, industryName])
}

model AlumniResume {
  alumni      Alumni @relation(fields: [alumniEmail], references: [email])
  alumniEmail String
  resume      Resume @relation(fields: [resumeId], references: [id])
  resumeId    String @unique @db.Uuid
  career      Career @relation(fields: [careerId], references: [id])
  careerId    String @db.Uuid

  @@id([alumniEmail, resumeId, careerId])
}
